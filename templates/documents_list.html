{% extends "base_team.html" %}
{% block team_content %}
<h2>Documents</h2>
  <form method="get" class="mb-3 d-flex">
    <input type="text" name="search" class="form-control me-2" placeholder="Search by document name..." value="{{ search }}">
    <button type="submit" class="btn btn-primary">Search</button>
    <a href="{{ url_for('documents_list') }}" class="btn btn-secondary ms-2">Clear</a>
  </form>
  <form method="get" class="mb-3">
    <label for="sort" class="form-label">Sort by:</label>
    <select name="sort" id="sort" class="form-select" onchange="this.form.submit()">
      <option value="recently_viewed" {% if sort == 'recently_viewed' %}selected{% endif %}>Recently Viewed</option>
      <option value="recently_added" {% if sort == 'recently_added' %}selected{% endif %}>Recently Added</option>
      <option value="client_alpha" {% if sort == 'client_alpha' %}selected{% endif %}>Client (A-Z)</option>
      <option value="case_alpha" {% if sort == 'case_alpha' %}selected{% endif %}>Case (A-Z)</option>
      <option value="name_alpha" {% if sort == 'name_alpha' %}selected{% endif %}>Document Name (A-Z)</option>
    </select>
  </form>
  <a href="{{ url_for('document_create') }}" class="btn btn-primary mb-3">New Document</a>
  <table class="table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Client</th>
        <th>Case</th>
        <th>Uploaded</th>
        <th>Last Viewed</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for doc in documents %}
      <tr>
        <td><a href="{{ url_for('document_detail', doc_id=doc.id) }}">{{ doc.filename }}</a></td>
        <td>{{ doc.client.name if doc.client else "" }}</td>
        <td>{{ doc.case.style if doc.case else "" }}</td>
        <td>{{ doc.uploaded_at.strftime('%Y-%m-%d') }}</td>
        <td>{{ doc.last_viewed_at.strftime('%Y-%m-%d') if doc.last_viewed_at else "" }}</td>
        <td>
          <a href="{{ url_for('document_edit', doc_id=doc.id) }}" class="btn btn-sm btn-secondary">Edit</a>
          <form action="{{ url_for('document_delete', doc_id=doc.id) }}" method="POST" style="display:inline;">
            <button class="btn btn-sm btn-danger" type="submit" onclick="return confirm('Delete this document?')">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}